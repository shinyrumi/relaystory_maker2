<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë¦´ë ˆì´ ì´ì•¼ê¸° ê³µì‘ì†Œ ğŸ“ (Sheets ì €ì¥)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Gaegu:wght@300;400;700&family=Nanum+Pen+Script&family=Stylish&family=Sunflower:wght@300;500;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Sunflower', sans-serif;
            background-image: url("https://www.transparenttextures.com/patterns/stitched-wool.png");
        }
        .font-gaegu { font-family: 'Gaegu', cursive; }
        .font-nanum-pen { font-family: 'Nanum Pen Script', cursive; }
        .font-stylish { font-family: 'Stylish', sans-serif; }

        .container-wrapper {
            background-color: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border: 5px groove #fecaca; 
            box-shadow: 0 20px 40px rgba(0,0,0,0.3), 0 0 0 15px rgba(255,255,255,0.7), 0 0 0 18px #fecaca;
        }

        .title-text {
            font-family: 'Stylish', sans-serif;
            font-size: 3.2rem; 
            letter-spacing: 2px;
            text-shadow: 3px 3px 0px #fef3c7, 5px 5px 0px #fde68a, 2px 2px 8px rgba(0,0,0,0.2); 
        }
        .choice-button {
            font-family: 'Gaegu', cursive;
            font-size: 1.2rem; 
            border: 3px outset; 
            transition: all 0.2s ease-out;
            box-shadow: 0 5px 10px -2px rgba(0,0,0,0.15), 0 3px 7px -2px rgba(0,0,0,0.1);
        }
        .choice-button:hover {
            transform: translateY(-5px) scale(1.05);
            box-shadow: 0 15px 25px -5px rgba(0,0,0,0.2), 0 8px 10px -6px rgba(0,0,0,0.15);
        }
        .story-stage-card {
            background-color: #feefc7; 
            border: 3px dashed #fcd34d; 
            box-shadow: 7px 7px 0px #fca120; 
        }
        .story-stage-name { font-family: 'Nanum Pen Script', cursive; font-size: 3rem; color: #d97706; }
        .story-stage-prompt { font-family: 'Sunflower', sans-serif; font-size: 1.2rem; color: #b45309; }

        .story-output-card {
            background-color: #e0f2fe; 
            border: 3px dotted #7dd3fc; 
            box-shadow: 0 0 25px rgba(56, 189, 248, 0.3);
            background-image: url("https://www.transparenttextures.com/patterns/worn-dots.png");
        }
        .story-output-card h3 { font-family: 'Stylish', sans-serif; color: #0369a1; } 
        .story-output-text { font-family: 'Nanum Pen Script', cursive; font-size: 1.7rem; line-height: 2.6rem; color: #075985; } 
        .story-segment { margin-bottom: 1.5rem; padding-bottom: 1rem; border-bottom: 1px dashed #bae6fd; } 
        .story-segment:last-child { border-bottom: none; }
        .segment-author { font-family: 'Gaegu', cursive; font-size: 1rem; color: #0c4a6e; display: block; margin-bottom: 0.3rem; font-weight: bold;} 
        
        .completed-story-card {
            background: linear-gradient(135deg, #dcfce7, #bbf7d0); 
            border: 4px solid #86efac; 
        }
        .completed-story-card h2 { font-family: 'Stylish', sans-serif; color: #15803d; } 
        .completed-story-text { font-family: 'Nanum Pen Script', cursive; font-size: 1.8rem; line-height: 2.7rem; color: #14532d; } 
        
        .text-input-area { 
            border: 3px dashed #fda4af; background-color: #fff1f2; padding: 1rem; border-radius: 0.5rem; margin-top: 1.5rem; margin-bottom: 1.5rem;
        }
        .text-input-area textarea, .text-input-area input {
            font-family: 'Gaegu', cursive; border-color: #f43f5e; width: 100%; padding: 0.5rem; border-width: 2px; border-radius: 0.375rem;
        }
        .text-input-area button { font-family: 'Stylish', sans-serif; }
        .text-input-area label { display: block; font-size: 0.875rem; font-weight: 500; color: #be123c; margin-bottom: 0.25rem; }

        #message-box { /* ì´ì „ ìŠ¤íƒ€ì¼ ìœ ì§€ */ }
        .control-button { 
            font-family: 'Stylish', sans-serif; font-size: 1.2rem; border: 3px outset;
            padding: 0.7rem 1.8rem; margin: 0.5rem; border-radius: 9999px; 
            transition: all 0.2s ease-in-out;
        }
        .control-button:hover { transform: scale(1.05); box-shadow: 0 4px 10px rgba(0,0,0,0.2); }

        .decision-button { font-family: 'Stylish', sans-serif !important; font-size: 1.2rem !important; }
    </style>
</head>
<body class="min-h-screen flex flex-col items-center justify-center p-4">

    <div class="container-wrapper p-6 sm:p-10 rounded-3xl w-full max-w-4xl">
        <header class="mb-10 text-center">
            <img src="https://placehold.co/130x130/fde68a/f59e0b?text=Sheets&font=Gaegu" alt="ì‹œíŠ¸ ì €ì¥ ì•„ì´ì½˜" class="mx-auto mb-5 rounded-full shadow-xl border-4 border-white">
            <h1 class="title-text text-orange-500">ë¦´ë ˆì´ ì´ì•¼ê¸° ê³µì‘ì†Œ ğŸ“</h1>
            <p class="text-slate-700 mt-4 text-xl font-gaegu">ì¹œêµ¬ë“¤ê³¼ í•¨ê»˜ ìƒìƒì˜ ë‚˜ë˜ë¥¼ í¼ì³ Google Sheetsì— ê¸°ë¡í•´ë´ìš”!</p>
        </header>

        <div id="initial-setup-section" class="text-input-area">
            <h3 class="text-xl font-stylish text-rose-600 mb-3 text-center">ì´ì•¼ê¸° ì‹œì‘ ì¤€ë¹„!</h3>
            <div>
                <label for="student-name">ì´ë¦„:</label>
                <input type="text" id="student-name" placeholder="ì˜ˆ: í™ê¸¸ë™">
            </div>
            <div class="mt-3">
                <label for="student-id">í•™ë²ˆ (ë˜ëŠ” ë³„ëª…):</label>
                <input type="text" id="student-id" placeholder="ì˜ˆ: 10101 ë˜ëŠ” ì´ì•¼ê¸°ìš”ì •">
            </div>
            <div class="mt-4">
                <label for="paste-story-area">ì´ì–´ì„œ ì‘ì„±í•  ì´ì•¼ê¸°ê°€ ìˆë‹¤ë©´ ì—¬ê¸°ì— ë¶™ì—¬ë„£ìœ¼ì„¸ìš” (ì—†ìœ¼ë©´ ë¹„ì›Œë‘ì„¸ìš”):</label>
                <textarea id="paste-story-area" rows="5" placeholder="ì´ì „ì— ì¹œêµ¬ê°€ ì „ë‹¬í•´ì¤€ ì´ì•¼ê¸° ë‚´ìš©ì„ ì—¬ê¸°ì— ë¶™ì—¬ë„£ìœ¼ì„¸ìš”..."></textarea>
            </div>
            <button id="start-story-button" class="mt-4 w-full bg-rose-500 hover:bg-rose-600 text-white font-semibold py-2.5 px-4 rounded-lg shadow-md text-lg">
                ì´ì•¼ê¸° ì‹œì‘ ë˜ëŠ” ì´ì–´ê°€ê¸°!
            </button>
        </div>

        <div id="main-story-interface" class="hidden"> 
            <div id="stage-info" class="story-stage-card mb-8 p-6 rounded-xl relative">
                <img src="https://placehold.co/60x60/d1d5db/4b5563?text=Idea&font=NanumPenScript" alt="ì•„ì´ë””ì–´ ì•„ì´ì½˜" class="absolute top-[-25px] left-[-25px] transform rotate-[-20deg] opacity-80">
                <h2 id="stage-name-display" class="story-stage-name mb-2"></h2>
                <p id="stage-prompt-display" class="story-stage-prompt"></p>
                <p id="instruction-text-display" class="instruction-text mt-3">ì•„ë˜ ì„ íƒì§€ë¥¼ ê³ ë¥´ê±°ë‚˜ ì§ì ‘ ë‚´ìš©ì„ ì¶”ê°€í•˜ì—¬ ì´ì•¼ê¸°ë¥¼ ì´ì–´ê°€ì„¸ìš”.</p>
            </div>

            <div id="choices-container" class="grid grid-cols-1 md:grid-cols-2 gap-4 sm:gap-6 mb-6"></div>
            
            <div id="user-input-section" class="text-input-area hidden">
                <textarea id="user-custom-text" rows="3" placeholder="ì—¬ê¸°ì— ë‚˜ë§Œì˜ ì´ì•¼ê¸°ë¥¼ ììœ ë¡­ê²Œ ì ì–´ë³´ì„¸ìš”..."></textarea>
                <button id="add-custom-text-button" class="mt-3 w-full bg-rose-500 hover:bg-rose-600 text-white font-semibold py-2.5 px-4 rounded-lg shadow-md text-lg">
                    ì´ ë‚´ìš© ì¶”ê°€ & Sheetsì— ì €ì¥!
                </button>
            </div>

            <div id="story-output-container" class="story-output-card mb-8 p-6 rounded-lg min-h-[200px] sm:min-h-[250px] relative">
                <img src="https://placehold.co/70x70/c7d2fe/4338ca?text=Scroll&font=Gaegu" alt="ë‘ë£¨ë§ˆë¦¬ ì•„ì´ì½˜" class="absolute bottom-[-30px] right-[-25px] opacity-75 transform rotate-[10deg]">
                <h3 class="text-2xl font-bold mb-4">ğŸ“– ì§€ê¸ˆê¹Œì§€ì˜ ì´ì•¼ê¸° ìŠ¤ì¼€ì¹˜:</h3>
                <div id="story-output" class="story-output-text">
                    ì´ì•¼ê¸°ê°€ ì—¬ê¸°ì— ìŠ¤ì¼€ì¹˜ë©ë‹ˆë‹¤...
                </div>
            </div>
            <div class="text-center mb-6">
                 <button id="copy-current-story-button" class="control-button bg-sky-500 hover:bg-sky-600 text-white border-sky-600">ğŸ“‹ í˜„ì¬ê¹Œì§€ ì´ì•¼ê¸° ë³µì‚¬ (ë‹¤ìŒ ì¹œêµ¬ì—ê²Œ)</button>
            </div>
        </div>
        
        <div id="completed-story-container" class="completed-story-card hidden mb-6 p-8 rounded-xl text-center">
            <img src="https://placehold.co/130x130/fef08a/eab308?text=Tada&font=Gaegu" alt="ì™„ì„± ì¶•í•˜ ì•„ì´ì½˜" class="mx-auto mb-5">
            <h2 class="text-4xl font-bold mb-4">ğŸ‰ ë“œë””ì–´, ë‚˜ë§Œì˜ ëŒ€ì„œì‚¬ì‹œ ì™„ì„±! ğŸ‰</h2>
            <div id="final-story-output" class="completed-story-text text-left p-5 bg-white/60 rounded-lg min-h-[200px]"></div>
        </div>

        <div id="controls" class="text-center mt-10 flex flex-wrap justify-center">
            <button id="reset-button" class="control-button bg-red-400 hover:bg-red-500 text-white border-red-500">ğŸ—‘ï¸ ëª¨ë“  ë‚´ìš© ì§€ìš°ê³  ì™„ì „ ì²˜ìŒë¶€í„°</button>
        </div>
    </div>

    <div id="message-box" class="bg-slate-800 text-white"></div>

    <script>
        // #############################################################################
        // ## ì¤‘ìš”! ì•„ë˜ ë³€ìˆ˜ì— ì„ ìƒë‹˜ì˜ Google Apps Script ì›¹ ì•± URLì„ ë„£ì–´ì£¼ì„¸ìš”! ##
        // #############################################################################
        const APPS_SCRIPT_WEB_APP_URL = ""; // ì˜ˆ: "https://script.google.com/macros/s/ì—¬ê¸°ì—_ì„ ìƒë‹˜ì˜_ì›¹ì•±_ID/exec";
        // ë§Œì•½ APPS_SCRIPT_WEB_APP_URLì´ ë¹„ì–´ìˆìœ¼ë©´, Google Sheets ì €ì¥ì€ ì‹œë„ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.

        // DOM ìš”ì†Œë“¤ (ì´ì „ê³¼ ìœ ì‚¬)
        const initialSetupSection = document.getElementById('initial-setup-section');
        const studentNameInput = document.getElementById('student-name');
        const studentIdInput = document.getElementById('student-id');
        const pasteStoryArea = document.getElementById('paste-story-area');
        const startStoryButton = document.getElementById('start-story-button');
        const mainStoryInterface = document.getElementById('main-story-interface');
        const stageNameDisplay = document.getElementById('stage-name-display');
        const stagePromptDisplay = document.getElementById('stage-prompt-display');
        const instructionTextDisplay = document.getElementById('instruction-text-display');
        const choicesContainer = document.getElementById('choices-container');
        const storyOutput = document.getElementById('story-output');
        const resetButton = document.getElementById('reset-button'); 
        const copyCurrentStoryButton = document.getElementById('copy-current-story-button');
        const stageInfoDiv = document.getElementById('stage-info');
        const storyOutputContainer = document.getElementById('story-output-container');
        const completedStoryContainer = document.getElementById('completed-story-container');
        const finalStoryOutput = document.getElementById('final-story-output');
        const userInputSection = document.getElementById('user-input-section');
        const userCustomTextArea = document.getElementById('user-custom-text');
        const addCustomTextButton = document.getElementById('add-custom-text-button');

        let currentStepIndex = 0;
        let storySegments = []; 
        let currentAuthor = "";
        let currentAuthorNameOnly = ""; // ì´ë¦„ë§Œ (Apps Script ì „ì†¡ìš©)
        let currentAuthorIdOnly = "";   // í•™ë²ˆë§Œ (Apps Script ì „ì†¡ìš©)
        let isDecisionPhase = false;

        const buttonColorPalettes = [ /* ì´ì „ê³¼ ë™ì¼ */ ];
        const storySteps = [ /* ì´ì „ê³¼ ë™ì¼ */ ];

        function showMessage(message, type = 'info') { /* ì´ì „ê³¼ ë™ì¼ */ }
        function parsePastedStory(pastedText) { /* ì´ì „ê³¼ ë™ì¼ (ê°œì„ ëœ ë²„ì „ ì‚¬ìš©) */ 
            const segments = [];
            const lines = pastedText.split('\n');
            let currentAuthorForParse = "ì•Œ ìˆ˜ ì—†ëŠ” ì‘ì„±ì";
            let currentTextForParse = "";

            const authorRegex = /^\[ì‘ì„±ì:\s*(.+?)\s*\]$/; 
            const separatorRegex = /^~+.*?~+$/; 
            const titleRegex = /^===.*?===$/; // ì œëª© í˜•ì‹ ì¶”ê°€

            for (const line of lines) {
                const authorMatch = line.match(authorRegex);
                const separatorMatch = line.match(separatorRegex);
                const titleMatch = line.match(titleRegex);

                if (titleMatch) { // ì œëª© ì¤„ì€ ê±´ë„ˆëœ€
                    continue;
                } else if (authorMatch) {
                    if (currentTextForParse.trim() !== "") {
                        segments.push({ author: currentAuthorForParse, text: currentTextForParse.trim() + " " });
                    }
                    currentAuthorForParse = authorMatch[1];
                    currentTextForParse = "";
                } else if (separatorMatch) {
                     if (currentTextForParse.trim() !== "") {
                        segments.push({ author: currentAuthorForParse, text: currentTextForParse.trim() + " " });
                    }
                    segments.push({ author: "ì•Œë¦¼", text: line.trim() + "\n\n" });
                    currentAuthorForParse = "ì•Œ ìˆ˜ ì—†ëŠ” ì‘ì„±ì"; 
                    currentTextForParse = "";
                } else if (line.trim() !== "") {
                    currentTextForParse += line + "\n";
                }
            }
            if (currentTextForParse.trim() !== "") {
                segments.push({ author: currentAuthorForParse, text: currentTextForParse.trim() + " " });
            }
            return segments;
        }
        function updateStoryOutput() { /* ì´ì „ê³¼ ë™ì¼ */ }
        
        // Apps Scriptë¡œ ë°ì´í„° ì „ì†¡í•˜ëŠ” í•¨ìˆ˜
        async function sendToAppsScript(segmentData) {
            if (!APPS_SCRIPT_WEB_APP_URL) {
                console.warn("Apps Script Web App URLì´ ì„¤ì •ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤. Sheets ì €ì¥ì„ ê±´ë„ˆëœë‹ˆë‹¤.");
                return; // URL ì—†ìœ¼ë©´ ì‹¤í–‰ ì•ˆ í•¨
            }

            const dataToSend = {
                name: currentAuthorNameOnly, // ì´ë¦„ë§Œ
                id: currentAuthorIdOnly,     // í•™ë²ˆë§Œ
                segment: segmentData.text    // ì´ì•¼ê¸° ì¡°ê° í…ìŠ¤íŠ¸
            };

            try {
                const response = await fetch(APPS_SCRIPT_WEB_APP_URL, {
                    method: "POST",
                    mode: "no-cors", // Apps ScriptëŠ” ë³´í†µ no-corsë¡œ í•´ì•¼ ê°„ë‹¨íˆ ì‘ë™ (ì‘ë‹µì€ ëª» ë°›ìŒ)
                                     // ë˜ëŠ” Apps Script ìª½ì—ì„œ CORS í—¤ë”ë¥¼ ì„¤ì •í•´ì•¼ í•¨
                                     // ì—¬ê¸°ì„œëŠ” ì‘ë‹µì„ ë°›ì§€ ì•ŠëŠ” í˜•íƒœë¡œ ë‹¨ìˆœí™”
                    // headers: { "Content-Type": "application/json", }, // mode: 'no-cors'ì—ì„œëŠ” Content-Type ì„¤ì •ì´ ì œí•œë  ìˆ˜ ìˆìŒ
                    // body: JSON.stringify(dataToSend)
                    
                    // Apps Scriptì—ì„œ e.postData.contentsë¡œ ë°›ìœ¼ë ¤ë©´ text/plainìœ¼ë¡œ ë³´ë‚´ëŠ” ê²ƒì´ ë” ì•ˆì •ì ì¼ ìˆ˜ ìˆìŒ
                    // ë˜ëŠ” URLSearchParams ì‚¬ìš©
                     body: new URLSearchParams(dataToSend).toString(), // form-data í˜•ì‹ìœ¼ë¡œ ì „ì†¡
                     headers: { 'Content-Type': 'application/x-www-form-urlencoded' }

                });
                // mode: 'no-cors'ì—ì„œëŠ” ì‘ë‹µì„ í™•ì¸í•  ìˆ˜ ì—†ìŒ. ì„±ê³µí–ˆë‹¤ê³  ê°€ì •.
                showMessage("ì´ì•¼ê¸° ì¡°ê°ì´ Google Sheetsë¡œ ì „ì†¡ë˜ì—ˆìŠµë‹ˆë‹¤ (ë˜ëŠ” ì‹œë„ë¨).", "info");
                console.log("Data sent to Apps Script (or attempted):", dataToSend);

            } catch (error) {
                console.error("Apps Scriptë¡œ ë°ì´í„° ì „ì†¡ ì¤‘ ì˜¤ë¥˜:", error);
                showMessage("ì´ì•¼ê¸° ì¡°ê°ì„ Sheetsë¡œ ì „ì†¡ ì¤‘ í†µì‹  ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.", "error");
            }
        }


        startStoryButton.addEventListener('click', () => {
            const name = studentNameInput.value.trim();
            const id = studentIdInput.value.trim();
            const pastedText = pasteStoryArea.value.trim();

            if (!name || !id) {
                showMessage("ì´ë¦„ê³¼ í•™ë²ˆ(ë³„ëª…)ì„ ëª¨ë‘ ì…ë ¥í•´ì£¼ì„¸ìš”!", "error");
                return;
            }
            currentAuthorNameOnly = name;
            currentAuthorIdOnly = id;
            currentAuthor = `${name} (${id})`;
            
            if (pastedText) {
                storySegments = parsePastedStory(pastedText);
                const lastSegment = storySegments.length > 0 ? storySegments[storySegments.length - 1] : null;
                if (lastSegment && lastSegment.author === "ì•Œë¦¼" && lastSegment.text.includes("ë‹¤ìŒ ì‘ê°€ì˜ ì´ì•¼ê¸°")) {
                    currentStepIndex = 1; 
                } else if (storySegments.length > 0) {
                    currentStepIndex = 1; 
                    storySegments.push({ author: "ì•Œë¦¼", text: "\n~~~~~~~~~~~~~ ë‹¤ìŒ ì‘ê°€ì˜ ì´ì•¼ê¸° ~~~~~~~~~~~~~\n" });
                } else { 
                    storySegments = [];
                    currentStepIndex = 0;
                }
                showMessage("ì´ì „ ì´ì•¼ê¸°ë¥¼ ì„±ê³µì ìœ¼ë¡œ ë¶ˆëŸ¬ì™”ìŠµë‹ˆë‹¤! ì´ì•¼ê¸°ë¥¼ ì´ì–´ê°€ì„¸ìš”.", "success");
            } else { 
                storySegments = [];
                currentStepIndex = 0;
                showMessage(`${currentAuthor}ë‹˜, í™˜ì˜í•©ë‹ˆë‹¤! ìƒˆë¡œìš´ ì´ì•¼ê¸°ë¥¼ ì‹œì‘í•˜ì„¸ìš”.`, "success");
            }
            
            initialSetupSection.classList.add('hidden');
            mainStoryInterface.classList.remove('hidden');
            completedStoryContainer.classList.add('hidden'); 
            
            renderStep();
        });

        function renderStep() { /* ì´ì „ê³¼ ê±°ì˜ ë™ì¼, Apps Script í˜¸ì¶œ ë¶€ë¶„ ì—†ìŒ */ }
        
        addCustomTextButton.addEventListener('click', () => {
            const customText = userCustomTextArea.value.trim();
            if (customText) {
                const newSegment = { author: currentAuthor, text: customText + " " };
                handleChoice(newSegment.text, true); // isCustom = true
                userInputSection.classList.add('hidden');
                userCustomTextArea.value = "";
            } else {
                showMessage("ì¶”ê°€í•  ë‚´ìš©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”!", "error");
            }
        });

        function handleChoice(segmentText, isCustom = false) {
            const newSegmentData = { author: currentAuthor, text: segmentText };
            storySegments.push(newSegmentData);
            sendToAppsScript(newSegmentData); // ì„ íƒ ë˜ëŠ” ì§ì ‘ ì…ë ¥ ì‹œ Apps Scriptë¡œ ì „ì†¡

            currentStepIndex++;
            if (currentStepIndex >= storySteps.length) { 
                handleEndOfChapter();
            } else {
                renderStep();
            }
            choicesContainer.querySelectorAll('.choice-button').forEach(btn => btn.disabled = false);
            showMessage("ì¢‹ì•„ìš”! ì´ì•¼ê¸°ê°€ ì´ì–´ì§€ê³  Sheetsì— ê¸°ë¡(ì‹œë„)ë˜ì—ˆìŠµë‹ˆë‹¤.", "success");
        }

        function handleEndOfChapter() { /* ì´ì „ê³¼ ë™ì¼ */ }
        function finalizeStory() { /* ì´ì „ê³¼ ë™ì¼ */ }

        function continueStoryRelay() { // ë‹¤ìŒ í•™ìƒì—ê²Œ ë„˜ê¸¸ ë•Œ
            isDecisionPhase = false;
            choicesContainer.innerHTML = ""; 
            
            mainStoryInterface.classList.add('hidden');
            initialSetupSection.classList.remove('hidden'); 
            
            studentNameInput.value = ""; 
            studentIdInput.value = "";
            pasteStoryArea.value = ""; // ë¶™ì—¬ë„£ê¸° ì˜ì—­ ì´ˆê¸°í™”
            
            // currentStepIndexëŠ” ìƒˆ í•™ìƒì´ ë¶™ì—¬ë„£ì€ ë‚´ìš©ì— ë”°ë¼ startStoryButtonì—ì„œ ê²°ì •ë¨
            // ë˜ëŠ” ì—¬ê¸°ì„œ ê°•ì œë¡œ currentStepIndex = 0; ìœ¼ë¡œ ì„¤ì •í•  ìˆ˜ë„ ìˆìŒ
            
            updateStoryOutput(); 
            showMessage("ë‹¤ìŒ ì‘ê°€ë‹˜, ì •ë³´ë¥¼ ì…ë ¥í•˜ê³  ì´ì „ ì´ì•¼ê¸°ë¥¼ ë¶™ì—¬ë„£ê±°ë‚˜ ìƒˆë¡œ ì‹œì‘í•˜ì„¸ìš”!", "info");
        }
        
        resetButton.addEventListener('click', () => {
            if (confirm("ì •ë§ë¡œ ëª¨ë“  ë‚´ìš©ì„ ì§€ìš°ê³  ì™„ì „íˆ ì²˜ìŒë¶€í„° ìƒˆë¡œ ì‹œì‘í•˜ì‹œê² ìŠµë‹ˆê¹Œ? ì´ ì‘ì—…ì€ Google Sheetsì— ì´ë¯¸ ì €ì¥ëœ ë‚´ìš©ì„ ì§€ìš°ì§€ëŠ” ì•ŠìŠµë‹ˆë‹¤.")) {
                // í´ë¼ì´ì–¸íŠ¸ ì¸¡ ìƒíƒœë§Œ ì´ˆê¸°í™”
                isDecisionPhase = false; 
                currentStepIndex = 0;
                storySegments = [];
                currentAuthor = "";
                currentAuthorNameOnly = "";
                currentAuthorIdOnly = "";
                
                mainStoryInterface.classList.add('hidden');
                completedStoryContainer.classList.add('hidden');
                
                initialSetupSection.classList.remove('hidden');
                studentNameInput.value = "";
                studentIdInput.value = "";
                pasteStoryArea.value = "";
                studentNameInput.focus();
                
                updateStoryOutput();
                showMessage("ëª¨ë“  ì´ì•¼ê¸°ê°€ ì›¹ì•±ì—ì„œ ì´ˆê¸°í™”ë˜ì—ˆìŠµë‹ˆë‹¤. ì‘ê°€ ì •ë³´ë¥¼ ì…ë ¥í•˜ê³  ìƒˆë¡œ ì‹œì‘í•˜ì„¸ìš”.", "info");
            }
        });

        copyCurrentStoryButton.addEventListener('click', () => { /* ì´ì „ê³¼ ë™ì¼ */ });

        window.onload = () => { /* ì´ì „ê³¼ ë™ì¼ */ };

    </script>
</body>
</html>
